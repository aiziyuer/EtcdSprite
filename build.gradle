apply plugin: 'java'
apply plugin: 'application'
apply plugin: "eclipse"

repositories {
    jcenter()
    maven {url 'repo'}
}

String swtGroupId='org.eclipse.swt', swtVersion='3.7.2'
def osDependencies = []
if (org.gradle.internal.os.OperatingSystem.current().isWindows()) {

    // 区分32位和64位
    String arch = System.getenv("PROCESSOR_ARCHITECTURE")
    String wow64Arch = System.getenv("PROCESSOR_ARCHITEW6432")
    String is64Arch = (arch != null && arch.endsWith("64")) \
                   || (wow64Arch != null && wow64Arch.endsWith("64")) ? "64" : "32"

    if(is64Arch) {
        osDependencies<<String.format("%s:%s:%s", swtGroupId, 'org.eclipse.swt.win32.win32.x86_64', swtVersion)
    }
    else {
        osDependencies<<String.format("%s:%s:%s", swtGroupId, 'org.eclipse.swt.win32.win32.x86', swtVersion)
    }

} else {

    // 全部编译
    osDependencies<<String.format("%s:%s:%s", swtGroupId, 'org.eclipse.swt.win32.win32.x86', swtVersion)
    osDependencies<<String.format("%s:%s:%s", swtGroupId, 'org.eclipse.swt.win32.win32.x86_64', swtVersion)
}


dependencies {
    // The production code uses Guava
    compile 'com.google.guava:guava:20.0'

    // 系统相关的依赖
    compile osDependencies

    // databing相关的几个类库
    compile 'org.eclipse.jface:org.eclipse.jface:3.7.0.v20110928-1505'
    compile 'org.eclipse.core:org.eclipse.core.commands:3.6.0.I20110111-0800'
    compile 'org.eclipse.osgi:org.eclipse.osgi:3.7.2.v20120110-1415'

    compile files('lib/com.ibm.icu_4.4.2.v20110823.jar')
    compile files('lib/org.eclipse.core.databinding_1.4.0.I20110111-0800.jar')
    compile files('lib/org.eclipse.core.databinding.beans_1.2.100.I20100824-0800.jar')
    compile files('lib/org.eclipse.core.databinding.observable_1.4.0.I20110222-0800.jar')
    compile files('lib/org.eclipse.core.databinding.property_1.4.0.I20110222-0800.jar')
    compile files('lib/org.eclipse.jface.databinding_1.5.0.I20100907-0800.jar')


    // 测试用框架
    testCompile 'junit:junit:4.12'
}

compileJava {
  sourceCompatibility = '1.8'
  targetCompatibility = '1.8'
}

build{
    mainClassName = "com.aiziyuer.app.CoreApplication"
    applicationDefaultJvmArgs = ["-Dgreeting.language=en"]
}